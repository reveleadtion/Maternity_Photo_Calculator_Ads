<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maternity Photo Timing | Two Wild Souls Photography</title>

    <style>
    @import url("https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;1,400;1,500&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap");

    :root {
        --bg: #FAFAF7;
        --text: #2E2F2C;
        --text-light: #6B6E6A;
        --accent: #7C8A5A;
        --gold: #C7B27A;
        --deep: #3F4438;
        --border: #DDD9D3;
        --error: #bf5040;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
        font-family: "DM Sans", sans-serif;
        background: var(--bg);
        color: var(--text);
        line-height: 1.5;
        min-height: 100vh;
        padding: 24px 16px 40px;
    }

    .container { max-width: 900px; margin: 0 auto; }

    .brand-header { text-align: center; margin-bottom: 20px; }
    .brand-logo { font-family: "Playfair Display", serif; font-size: clamp(28px, 7vw, 42px); font-weight: 400; color: var(--deep); margin-bottom: 4px; }
    .brand-logo span { color: var(--gold); font-style: italic; }
    .brand-tagline { font-size: 11px; font-weight: 500; letter-spacing: 1.2px; text-transform: uppercase; color: var(--accent); margin-bottom: 4px; }

    .tagline-excerpt {
        font-size: 11px; font-weight: 500; letter-spacing: 0.8px; text-transform: uppercase;
        color: var(--text-light); text-align: center; margin: 12px 0 20px; line-height: 1.6;
    }
    .tagline-excerpt strong { color: var(--deep); }

    .intro-section { text-align: center; margin-bottom: 24px; }
    .intro-title { font-family: "Playfair Display", serif; font-size: clamp(22px, 5vw, 28px); font-weight: 400; color: var(--deep); margin-bottom: 8px; }
    .intro-text { font-size: 14px; color: var(--text-light); line-height: 1.6; }

    .progress-bar { height: 3px; background: rgba(63,68,56,0.12); margin: 0 0 20px; border-radius: 2px; overflow: hidden; }
    .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), var(--gold)); transition: width 0.5s ease; }

    .dots { display: flex; justify-content: center; gap: 8px; margin: 0 0 16px; }
    .dot { width: 6px; height: 6px; border-radius: 50%; background: #E0DDD8; transition: all 0.3s; }
    .dot.active { background: var(--accent); transform: scale(1.4); }
    .dot.completed { background: var(--gold); transform: scale(1.1); }

    .step { display: none; animation: fadeIn 0.3s ease; }
    .step.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

    .question { font-family: "Playfair Display", serif; font-size: clamp(20px, 5vw, 26px); font-weight: 400; margin: 0 0 8px; text-align: center; }
    .hint { font-size: 13px; color: var(--text-light); font-style: italic; text-align: center; margin: 0 0 16px; }

    .options { display: grid; grid-template-columns: 1fr; gap: 12px; margin: 0 0 20px; }
    .option {
        padding: 16px; border: 1.5px solid var(--border); border-radius: 6px;
        cursor: pointer; transition: all 0.2s; background: white; text-align: center;
    }
    .option:hover { border-color: var(--accent); background: rgba(124,138,90,0.04); }
    .option.selected { border-color: var(--accent); background: rgba(124,138,90,0.08); box-shadow: 0 0 0 2px rgba(124,138,90,0.15); }
    .option-title { font-size: 15px; font-weight: 500; margin-bottom: 4px; }
    .option-desc { font-size: 12px; color: var(--text-light); }

    .date-picker {
        width: 100%; padding: 14px 20px; font-size: 15px; background: white;
        border: 1.5px solid var(--border); border-radius: 6px; cursor: pointer;
        text-align: center; transition: all 0.2s; margin-bottom: 16px;
        font-family: "DM Sans", sans-serif;
    }
    .date-picker:hover { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(124,138,90,0.1); }
    .date-placeholder { color: var(--text-light); }

    .checkbox-option { padding: 14px; border: 1.5px solid var(--border); border-radius: 6px; cursor: pointer; background: white; transition: all 0.2s; text-align: center; }
    .checkbox-option:hover { border-color: var(--accent); background: rgba(124,138,90,0.04); }
    .checkbox-option.selected { border-color: var(--accent); background: rgba(124,138,90,0.08); }
    .checkbox-label { font-size: 15px; font-weight: 500; }

    .buttons { display: flex; gap: 12px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
    .btn {
        padding: 12px 28px; font-size: 12px; font-weight: 500; letter-spacing: 0.8px;
        text-transform: uppercase; border-radius: 6px; cursor: pointer; transition: all 0.2s; min-width: 140px;
        font-family: "DM Sans", sans-serif;
    }
    .btn-back { background: transparent; border: 1.5px solid var(--border); color: var(--text-light); }
    .btn-back:hover { border-color: var(--text); color: var(--text); }
    .btn-next { background: linear-gradient(90deg, var(--accent), var(--gold)); color: white; border: none; }
    .btn-gold { background: linear-gradient(90deg, var(--accent), var(--gold)); color: white; border: none; }

    .error-msg { color: var(--error); font-size: 12px; text-align: center; margin: 8px 0; display: none; }
    .error-msg.show { display: block; }

    .loading-screen { text-align: center; padding: 60px 20px; display: none; }
    .spinner { width: 40px; height: 40px; border: 4px solid rgba(124,138,90,0.2); border-top: 4px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px; }
    @keyframes spin { to { transform: rotate(360deg); } }



    .footer-brand { text-align: center; margin-top: 40px; font-size: 11px; color: var(--text-light); opacity: 0.7; }

    /* Calendar */
    #calendar-overlay {
        display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.55);
        z-index: 1000; align-items: center; justify-content: center; padding: 16px;
    }
    #calendar-overlay.open { display: flex; }
    .calendar {
        background: white; border-radius: 12px; box-shadow: 0 16px 48px rgba(0,0,0,0.25);
        max-width: 360px; width: 100%; overflow: hidden;
    }
    .cal-header {
        display: flex; align-items: center; justify-content: space-between;
        padding: 16px 20px; background: var(--deep); color: white;
    }
    .cal-header span { font-family: "Playfair Display", serif; font-size: 17px; font-weight: 400; }
    .cal-header button { background: none; border: none; color: white; font-size: 22px; cursor: pointer; padding: 0 6px; line-height: 1; }
    .cal-weekdays {
        display: grid; grid-template-columns: repeat(7, 1fr);
        padding: 10px 12px 4px; gap: 2px;
        font-size: 11px; font-weight: 500; letter-spacing: 0.5px;
        text-transform: uppercase; color: var(--text-light); text-align: center;
    }
    .cal-days-grid {
        display: grid; grid-template-columns: repeat(7, 1fr);
        grid-template-rows: repeat(6, 1fr);
        padding: 4px 12px 12px; gap: 3px;
        height: 228px;
    }
    .cal-day {
        aspect-ratio: 1; display: flex; align-items: center; justify-content: center;
        font-size: 13px; border-radius: 50%; cursor: pointer; transition: all 0.15s;
        border: none; background: none; font-family: "DM Sans", sans-serif; color: var(--text);
    }
    .cal-day:hover:not(.disabled):not(.empty) { background: rgba(124,138,90,0.12); }
    .cal-day.selected { background: var(--accent); color: white; }
    .cal-day.today { font-weight: 700; color: var(--accent); }
    .cal-day.disabled { color: #CCC; cursor: not-allowed; }
    .cal-day.too-soon { color: #CCC; cursor: pointer; }
    .cal-day.too-soon:hover { background: rgba(191,80,64,0.08); color: #bf5040; }
    .cal-day.empty { pointer-events: none; }

    /* Too-soon popup */
    #too-soon-popup {
        display: none; position: absolute; left: 50%; transform: translateX(-50%);
        bottom: calc(100% + 8px); background: #3F4438; color: white;
        font-size: 12px; line-height: 1.5; padding: 10px 14px; border-radius: 8px;
        width: 240px; text-align: center; z-index: 10; pointer-events: none;
        box-shadow: 0 4px 16px rgba(0,0,0,0.25);
    }
    #too-soon-popup::after {
        content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
        border: 6px solid transparent; border-top-color: #3F4438;
    }
    #too-soon-popup.show { display: block; animation: fadeIn 0.2s ease; }
    .cal-days-wrapper { position: relative; }
    .cal-footer {
        display: flex; gap: 10px; padding: 12px 16px; border-top: 1px solid var(--border);
        justify-content: flex-end;
    }
    .cal-footer button { padding: 8px 20px; border-radius: 5px; font-size: 12px; font-weight: 500; cursor: pointer; font-family: "DM Sans", sans-serif; letter-spacing: 0.5px; text-transform: uppercase; }
    .btn-cancel { background: none; border: 1.5px solid var(--border); color: var(--text-light); }
    .btn-done { background: linear-gradient(90deg, var(--accent), var(--gold)); color: white; border: none; }

    @media (min-width: 500px) {
        .options { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
    }
    </style>
</head>
<body>

<div class="container">
    <div class="brand-header">
        <div class="brand-logo">Two Wild <span>Souls</span> Photography</div>
        <div class="brand-tagline">Metro Detroit Maternity Portraits</div>
    </div>

    <div class="tagline-excerpt">
        <strong>Pro Hair + Makeup Â· Designer Gowns Â· In-Studio & Outdoors Â· Fully Guided</strong>
    </div>

    <div class="intro-section">
        <h2 class="intro-title">Get Your Personalized Timing</h2>
        <p class="intro-text">
            Answer a few quick questions â†’ get your exact week window, booking urgency, and tips so you can reserve your spot before we fill up <i>(only 6 sessions/month)</i>.
        </p>
    </div>

    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
    <div class="dots" id="dots"></div>

    <!-- Step 1: Due Date -->
    <div class="step active" id="step-1">
        <div class="question">When is your due date?</div>
        <div class="hint">We'll calculate your ideal photo window from this.</div>
        <div class="date-picker" id="date-display" onclick="openCalendar()">
            <span id="selected-date" class="date-placeholder">Tap to select your due date...</span>
        </div>
        <div class="error-msg" id="error-1">Please select a due date to continue.</div>
        <div class="buttons">
            <button class="btn btn-next" onclick="validateStep1()">Next â†’</button>
        </div>
    </div>

    <!-- Step 2: First Baby -->
    <div class="step" id="step-2">
        <div class="question">Is this your first baby?</div>
        <div class="options">
            <div class="option" data-key="firstBaby" data-value="yes" onclick="selectOption(this)">
                <div class="option-title">Yes â€” first time!</div>
                <div class="option-desc">Exciting new chapter</div>
            </div>
            <div class="option" data-key="firstBaby" data-value="no" onclick="selectOption(this)">
                <div class="option-title">No â€” I've done this before</div>
                <div class="option-desc">Adding to the family</div>
            </div>
        </div>
        <div class="error-msg" id="error-2">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(1)">Back</button>
        </div>
    </div>

    <!-- Step 3: Multiples -->
    <div class="step" id="step-3">
        <div class="question">Are you expecting multiples?</div>
        <div class="options">
            <div class="option" data-key="multiples" data-value="yes" onclick="selectOption(this)">
                <div class="option-title">Yes â€” twins or more!</div>
            </div>
            <div class="option" data-key="multiples" data-value="no" onclick="selectOption(this)">
                <div class="option-title">No â€” just one</div>
            </div>
        </div>
        <div class="error-msg" id="error-3">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(2)">Back</button>
        </div>
    </div>

    <!-- Step 4: Preferred Style -->
    <div class="step" id="step-4">
        <div class="question">What look are you going for?</div>
        <div class="options">
            <div class="option" data-key="style" data-value="full" onclick="selectOption(this)">
                <div class="option-title">Full, dramatic bump</div>
                <div class="option-desc">Classic maternity look â€” beautifully round</div>
            </div>
            <div class="option" data-key="style" data-value="early" onclick="selectOption(this)">
                <div class="option-title">Earlier & more comfortable</div>
                <div class="option-desc">More energy, easier to move around</div>
            </div>
        </div>
        <div class="error-msg" id="error-4">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(3)">Back</button>
        </div>
    </div>

    <!-- Step 5: Setting -->
    <div class="step" id="step-5">
        <div class="question">Where would you love to shoot?</div>
        <div class="options">
            <div class="option" data-key="setting" data-value="outdoor" onclick="selectOption(this)">
                <div class="option-title">ğŸŒ¿ Outdoor</div>
                <div class="option-desc">Natural light, golden hour, greenery</div>
            </div>
            <div class="option" data-key="setting" data-value="indoor" onclick="selectOption(this)">
                <div class="option-title">ğŸ› Indoor / Studio</div>
                <div class="option-desc">Controlled, elegant, weather-proof</div>
            </div>
            <div class="option" data-key="setting" data-value="both" onclick="selectOption(this)">
                <div class="option-title">âœ¨ Both</div>
                <div class="option-desc">Best of both worlds</div>
            </div>
        </div>
        <div class="error-msg" id="error-5">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(4)">Back</button>
        </div>
    </div>

    <!-- Step 6: High-risk -->
    <div class="step" id="step-6">
        <div class="question">Any special considerations?</div>
        <div class="hint">Optional â€” helps us personalize your timing.</div>
        <div class="options" style="grid-template-columns:1fr; max-width: 400px; margin: 0 auto 20px;">
            <div class="checkbox-option" id="highRiskBox" onclick="toggleCheckbox()">
                <div class="checkbox-label" id="highRiskLabel">â˜ &nbsp;High-risk pregnancy</div>
            </div>
        </div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(5)">Back</button>
            <button class="btn btn-gold" onclick="calculate()">Get My Timing â†’</button>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading-screen" id="loading">
        <div class="spinner"></div>
        <div style="font-family:'Playfair Display',serif; font-size:22px; color:var(--deep); margin-bottom:8px;">Building Your Planâ€¦</div>
        <p style="font-size:13px;color:var(--text-light);">Calculating your perfect session window</p>
    </div>


    <div class="footer-brand">Â© Two Wild Souls Photography Â· Metro Detroit</div>
</div>

<!-- Calendar Modal -->
<div id="calendar-overlay" onclick="handleOverlayClick(event)">
    <div class="calendar">
        <div class="cal-header">
            <button onclick="changeMonth(-1)">â€¹</button>
            <span id="cal-header-text"></span>
            <button onclick="changeMonth(1)">â€º</button>
        </div>
        <div class="cal-weekdays">
            <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div>
            <div>Thu</div><div>Fri</div><div>Sat</div>
        </div>
        <div class="cal-days-wrapper">
        <div id="too-soon-popup">She's already past 32 weeks â€” unfortunately we can't accommodate sessions this late. Please call us to discuss options! ğŸ’›</div>
        <div id="cal-days-grid" class="cal-days-grid"></div>
    </div>
        <div class="cal-footer">
            <button class="btn-cancel" onclick="closeCalendar()">Cancel</button>
            <button class="btn-done" onclick="confirmCalendar()">Done</button>
        </div>
    </div>
</div>

<script>
// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const state = {
    dueDate: null,
    firstBaby: null,
    multiples: null,
    style: null,
    setting: null,
    highRisk: false
};

let currentStep = 1;
const totalSteps = 6;

// Calendar state
let calViewYear, calViewMonth, calTempDate = null;

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function init() {
    const now = new Date();
    calViewYear = now.getFullYear();
    calViewMonth = now.getMonth();
    buildDots();
    updateProgress();
}

// â”€â”€â”€ DOTS & PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildDots() {
    const container = document.getElementById('dots');
    container.innerHTML = '';
    for (let i = 1; i <= totalSteps; i++) {
        const d = document.createElement('div');
        d.className = 'dot' + (i === currentStep ? ' active' : i < currentStep ? ' completed' : '');
        d.id = 'dot-' + i;
        container.appendChild(d);
    }
}

function updateProgress() {
    const pct = ((currentStep - 1) / totalSteps) * 100;
    document.getElementById('progress-fill').style.width = pct + '%';
    buildDots();
}

// â”€â”€â”€ STEP NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function goToStep(n) {
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.getElementById('loading').style.display = 'none';
    const target = document.getElementById('step-' + n) || document.getElementById('step-results');
    if (target) target.classList.add('active');
    currentStep = n;
    updateProgress();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€â”€ STEP 1 VALIDATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function validateStep1() {
    if (!state.dueDate) {
        document.getElementById('error-1').classList.add('show');
        return;
    }
    document.getElementById('error-1').classList.remove('show');
    goToStep(2);
}

// â”€â”€â”€ OPTION SELECTION (steps 2â€“5) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectOption(el) {
    const key = el.dataset.key;
    const value = el.dataset.value;
    const stepNum = parseInt(el.closest('.step').id.replace('step-', ''));

    // Deselect siblings in same step
    el.closest('.options').querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');

    state[key] = value;

    // Hide error
    const err = document.getElementById('error-' + stepNum);
    if (err) err.classList.remove('show');

    // Auto-advance after short delay
    setTimeout(() => {
        if (stepNum < 6) goToStep(stepNum + 1);
    }, 280);
}

// â”€â”€â”€ CHECKBOX (step 6) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleCheckbox() {
    state.highRisk = !state.highRisk;
    const box = document.getElementById('highRiskBox');
    const label = document.getElementById('highRiskLabel');
    box.classList.toggle('selected', state.highRisk);
    label.textContent = (state.highRisk ? 'â˜‘' : 'â˜') + '  High-risk pregnancy';
}

// â”€â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openCalendar() {
    // Start from current selection or today
    if (state.dueDate) {
        calViewYear = state.dueDate.getFullYear();
        calViewMonth = state.dueDate.getMonth();
        calTempDate = new Date(state.dueDate);
    } else {
        // Jump straight to the first valid date (8 weeks from today)
        const firstValid = new Date();
        firstValid.setDate(firstValid.getDate() + 56);
        calViewYear = firstValid.getFullYear();
        calViewMonth = firstValid.getMonth();
        calTempDate = null;
    }
    renderCalendar();
    document.getElementById('calendar-overlay').classList.add('open');
}

function closeCalendar() {
    document.getElementById('calendar-overlay').classList.remove('open');
    calTempDate = null;
}

function confirmCalendar() {
    if (calTempDate) {
        state.dueDate = new Date(calTempDate);
        const opts = { year: 'numeric', month: 'long', day: 'numeric' };
        const dateEl = document.getElementById('selected-date');
        dateEl.textContent = state.dueDate.toLocaleDateString('en-US', opts);
        dateEl.classList.remove('date-placeholder');
        document.getElementById('error-1').classList.remove('show');
        document.getElementById('calendar-overlay').classList.remove('open');
        setTimeout(() => goToStep(2), 300);
    } else {
        document.getElementById('calendar-overlay').classList.remove('open');
    }
}

function handleOverlayClick(e) {
    if (e.target === document.getElementById('calendar-overlay')) closeCalendar();
}

function changeMonth(dir) {
    calViewMonth += dir;
    if (calViewMonth > 11) { calViewMonth = 0; calViewYear++; }
    if (calViewMonth < 0) { calViewMonth = 11; calViewYear--; }
    renderCalendar();
}

function renderCalendar() {
    const monthNames = ['January','February','March','April','May','June',
                        'July','August','September','October','November','December'];
    document.getElementById('cal-header-text').textContent = monthNames[calViewMonth] + ' ' + calViewYear;

    const grid = document.getElementById('cal-days-grid');
    grid.innerHTML = '';

    const today = new Date(); today.setHours(0,0,0,0);
    // Min selectable: today
    const minDate = new Date(today);

    const firstDay = new Date(calViewYear, calViewMonth, 1).getDay();
    const daysInMonth = new Date(calViewYear, calViewMonth + 1, 0).getDate();

    // Empty cells before first day
    for (let i = 0; i < firstDay; i++) {
        const empty = document.createElement('button');
        empty.className = 'cal-day empty';
        grid.appendChild(empty);
    }

    for (let d = 1; d <= daysInMonth; d++) {
        const btn = document.createElement('button');
        btn.className = 'cal-day';
        btn.textContent = d;

        const thisDate = new Date(calViewYear, calViewMonth, d);
        thisDate.setHours(0,0,0,0);

        const maxDate = new Date(today);
        maxDate.setDate(today.getDate() + 56); // due date must be 8+ weeks away (mom â‰¤32 weeks)

        if (thisDate < minDate) {
            // Past date â€” plain disabled
            btn.classList.add('disabled');
        } else if (thisDate < maxDate) {
            // Already past 32 weeks â€” tappable but shows error popup
            btn.classList.add('disabled', 'too-soon');
            btn.onclick = () => showTooSoonPopup();
        } else {
            // Valid selectable date
            if (thisDate.getTime() === today.getTime()) btn.classList.add('today');
            if (calTempDate) {
                const t = new Date(calTempDate); t.setHours(0,0,0,0);
                if (thisDate.getTime() === t.getTime()) btn.classList.add('selected');
            }
            btn.onclick = () => selectCalDay(thisDate, btn);
        }

        grid.appendChild(btn);
    }
}

function showTooSoonPopup() {
    const popup = document.getElementById('too-soon-popup');
    popup.classList.add('show');
    clearTimeout(window._tooSoonTimer);
    window._tooSoonTimer = setTimeout(() => popup.classList.remove('show'), 3500);
}

function selectCalDay(date, btn) {
    calTempDate = new Date(date);
    // Update visuals
    document.querySelectorAll('.cal-day').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
}

// â”€â”€â”€ CALCULATION & REDIRECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calculate() {
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.getElementById('loading').style.display = 'block';

    setTimeout(() => {
        const due = state.dueDate;
        const isFirst = state.firstBaby === 'yes';
        const multiples = state.multiples === 'yes';
        const style = state.style || 'full';
        const setting = state.setting;
        const highRisk = state.highRisk;

        const todayMs = new Date(); todayMs.setHours(0,0,0,0);
        const conception = new Date(due.getTime() - 280 * 86400000);
        const daysSince = Math.floor((todayMs - conception) / 86400000);
        const currentWeek = Math.max(1, Math.min(42, Math.ceil(daysSince / 7)));

        let startWeek, endWeek;
        if (multiples) {
            startWeek = 24; endWeek = 28;
        } else if (!isFirst) {
            startWeek = style === 'full' ? 28 : 26;
            endWeek   = style === 'full' ? 32 : 30;
        } else {
            startWeek = style === 'full' ? 30 : 28;
            endWeek   = style === 'full' ? 34 : 32;
        }

        if (!multiples) {
            if (setting === 'outdoor') { startWeek = Math.max(20, startWeek - 2); endWeek = Math.max(22, endWeek - 2); }
            else if (setting === 'indoor') { startWeek = Math.min(32, startWeek + 1); endWeek = Math.min(34, endWeek + 1); }
        }

        if (highRisk && !multiples) { startWeek = Math.max(20, startWeek - 2); endWeek = Math.max(22, endWeek - 2); }

        endWeek   = Math.min(endWeek, 32);
        startWeek = Math.min(startWeek, 32);

        const isLate     = currentWeek >= 33;
        const isUrgent   = currentWeek === 32;
        const isInWindow = currentWeek >= startWeek && currentWeek <= endWeek && !isUrgent && !isLate;

        let context = 'early';
        if (isLate || isUrgent) context = 'late';
        else if (isInWindow) context = 'inWindow';
        else if (currentWeek > endWeek) context = 'pastWindow';

        const maternityUrl = 'https://twowildsoulsphotography.com/detroit-maternity-photographer-ads-custom';
        const newbornUrl   = 'https://twowildsoulsphotography.com/detroit-newborn-photographer-ads';
        const dest = isLate ? newbornUrl : maternityUrl;

        let bookByStr = '';
        if (!isLate && !isUrgent) {
            const bookDate = new Date(conception);
            bookDate.setDate(bookDate.getDate() + startWeek * 7 - 42);
            bookByStr = bookDate.toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'});
        } else if (isUrgent) {
            bookByStr = 'Today';
        }

        const params = new URLSearchParams({
            week:    currentWeek,
            status:  context,
            window:  isLate || isUrgent ? '' : `${startWeek}-${endWeek}`,
            bookby:  bookByStr,
            type:    isLate ? 'newborn' : 'maternity',
            style:   style,
            setting: setting || '',
            duedate: due.toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'})
        });

        const fbclid = new URLSearchParams(window.location.search).get('fbclid');
        if (fbclid) params.append('fbclid', fbclid);

        try {
            fbq('track', 'Lead', {
                content_name: 'Calculator Complete',
                content_category: context,
                value: currentWeek,
                currency: 'USD'
            });
        } catch(e) {}

        window.location.href = `${dest}?${params.toString()}`;
    }, 1600);
}

// â”€â”€â”€ START â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
init();
</script>

</body>
</html>
